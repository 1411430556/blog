import{_ as i,c as s,o as a,a8 as e}from"./chunks/framework.DpOJKwZ2.js";const u=JSON.parse('{"title":"Uniapp 踩坑记录","description":"","frontmatter":{"outline":2},"headers":[],"relativePath":"pit/uniapp.md","filePath":"pit/uniapp.md","lastUpdated":1744011833000}'),t={name:"pit/uniapp.md"},l=e('<h1 id="uniapp-踩坑记录" tabindex="-1">Uniapp 踩坑记录 <a class="header-anchor" href="#uniapp-踩坑记录" aria-label="Permalink to &quot;Uniapp 踩坑记录&quot;">​</a></h1><h2 id="使用uni-uploadfile方法上传图片-提示errmsg-uploadfile-fail" tabindex="-1">使用<code>uni.uploadFile</code>方法上传图片，提示<code>errMsg: &quot;uploadFile:fail</code> <a class="header-anchor" href="#使用uni-uploadfile方法上传图片-提示errmsg-uploadfile-fail" aria-label="Permalink to &quot;使用`uni.uploadFile`方法上传图片，提示`errMsg: &quot;uploadFile:fail`&quot;">​</a></h2><p>使用<code>uni.uploadFile</code>方法进行图片上传时，提示<code>errMsg: &quot;uploadFile:fail</code>，图片上传失败，上传图片的接口根本就没有调用。</p><h5 id="解决方法" tabindex="-1">解决方法 <a class="header-anchor" href="#解决方法" aria-label="Permalink to &quot;解决方法&quot;">​</a></h5><p>url 不能只传接口地址，要把完整的服务器地址拼接上去。</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">envConfig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">APP_SERVER_URL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}/${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">backend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">baseService</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}/api/ocrResource/s/ocrResource/fileUpld`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h5 id="解决过程" tabindex="-1">解决过程 <a class="header-anchor" href="#解决过程" aria-label="Permalink to &quot;解决过程&quot;">​</a></h5><p>虽然问题已经解决，并且解决的方法很简单，但是寻找整个问题解决办法的过程着实花费了不少时间，所以还是有必要记录一下解决的过程。</p><p>首先，接口没有调用，说明肯定是图片上传失败了，但是报错的信息目前还没有暴露出来，我们知道了有错误也无法定位到错误原因，只能再仔细看<code>uni.uploadFile</code> 的文档：</p><table><thead><tr><th>参数名</th><th style="text-align:right;">类型</th><th style="text-align:right;">必填</th><th style="text-align:center;">说明</th></tr></thead><tbody><tr><td>success</td><td style="text-align:right;">Function</td><td style="text-align:right;">否</td><td style="text-align:center;">接口调用成功的回调函数</td></tr><tr><td>file</td><td style="text-align:right;">Function</td><td style="text-align:right;">否</td><td style="text-align:center;">接口调用失败的回调函数</td></tr></tbody></table><p>加上<code>file</code>参数后，就可以看到报错的信息了：发现报错信息是<code>errMsg: &quot;uploadFile:fail</code></p><p>谷歌搜索了一番，有博客说<code>url</code>必须得填完整，于是把整个服务器地址拼接上去：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">envConfig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">APP_SERVER_URL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">backend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">baseService</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}/api/ocrResource/s/ocrResource/fileUpld`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>还是不行，报错信息还是<code>errMsg: &quot;uploadFile:fail</code></p><p>又搜索了一番，没有太大的收获，就在快要放弃的时候，发现自己的<code>url</code>少写了一个<code>/</code>...</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark has-diff vp-code"><code><span class="line diff remove"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">envConfig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">APP_SERVER_URL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">backend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">baseService</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}/api/ocrResource/s/ocrResource/fileUpld`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">,</span></span>\n<span class="line diff add"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">envConfig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">APP_SERVER_URL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}/${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">backend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">baseService</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}/api/ocrResource/s/ocrResource/fileUpld`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">,</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>原来是自己的<code>url</code>少写了一个<code>/</code>，也就是说根本原因还是路径不完整，导致图片上传失败。</p><blockquote><p>说实话<code>uniapp</code>的报错信息真是有点坑，无论是什么错误，都是<code>errMsg: &quot;uploadFile:fail</code>，根本无法分辨出来是什么错误。 我们只能靠调试的方式，来寻找问题的原因。 如果说是<code>url</code>错误好歹返回一个相对应的错误信息呗....</p></blockquote><p>这次解决问题的过程也给我个教训：</p><ol><li>如果有<code>fail</code>函数相关的错误处理函数，一定要处理，不要忽略，不然报错了也无法知道问题所在。</li><li>不要过度相信报错信息，要确保自己代码的逻辑、变量的正确性。</li></ol><p>测试 222</p>',21),n=[l];function p(h,d,r,k,o,c){return a(),s("div",null,n)}const g=i(t,[["render",p]]);export{u as __pageData,g as default};
